<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Todo List</title>
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <div id="app">
    <div class='input-container'>
      <input id='input' class='input' type='text'>
      <button id='add-button' class='add-button'>Ekle</button>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      let itemList = [];
      let input = '';
      let booleanValue = false;

      const addItem = (inputtedTitle) => {
        const newItem = {
          id: itemList.length + 1,
          title: inputtedTitle,
          completed: false
        };
        itemList.push(newItem);
        render();
      };

      const deleteItem = (id) => {
        const index = itemList.findIndex(item => item.id === id);
        itemList.splice(index, 1);
        render();
      };

      const toggleComplete = (id) => {
        const index = itemList.findIndex(item => item.id === id);
        itemList[index].completed = !itemList[index].completed;
        render();
      };

      const asc = (item) => {
        const index = itemList.findIndex(el => el === item);
        if (index > 0) {
          const temp = itemList[index];
          itemList[index] = itemList[index - 1];
          itemList[index - 1] = temp;
          render();
        }
      };

      const desc = (item) => {
        const index = itemList.findIndex(el => el === item);
        if (index < itemList.length - 1) {
          const temp = itemList[index];
          itemList[index] = itemList[index + 1];
          itemList[index + 1] = temp;
          render();
        }
      };

      const render = () => {
        const appDiv = document.getElementById('app');
        appDiv.innerHTML = '';

        const inputField = document.createElement('input');
        inputField.id = 'input';
        inputField.classList.add('input');
        inputField.type = 'text';
        inputField.value = input;
        inputField.addEventListener('input', function (event) {
          input = event.target.value;
        });

        const addButton = document.createElement('button');
        addButton.id = 'add-button';
        addButton.classList.add('add-button');
        addButton.textContent = 'Ekle';
        addButton.addEventListener('click', function () {
          addItem(input);
          input = '';
        });

        const inputContainerDiv = document.createElement('div');
        inputContainerDiv.classList.add('input-container');
        inputContainerDiv.appendChild(inputField);
        inputContainerDiv.appendChild(addButton);
        appDiv.appendChild(inputContainerDiv);

        itemList.forEach(item => {
          const listItemDiv = document.createElement('div');
          listItemDiv.classList.add('listItem');

          const sortButtonsContainerDiv = document.createElement('div');
          sortButtonsContainerDiv.classList.add('sort-buttons-container');

          const ascButton = document.createElement('div');
          ascButton.classList.add('sort', 'asc');
          ascButton.textContent = '<';
          ascButton.addEventListener('click', function () {
            asc(item);
            saveToLocalStorage();
          });

          const descButton = document.createElement('div');
          descButton.classList.add('sort', 'desc');
          descButton.textContent = '>';
          descButton.addEventListener('click', function () {
            desc(item);
            saveToLocalStorage();
          });

          sortButtonsContainerDiv.appendChild(ascButton);
          sortButtonsContainerDiv.appendChild(descButton);

          const checkbox = document.createElement('input');
          checkbox.type = 'checkbox';
          checkbox.classList.add('check');
          checkbox.checked = item.completed;
          checkbox.addEventListener('change', function () {
            toggleComplete(item.id);
            saveToLocalStorage();
          });

          const listItemTitleDiv = document.createElement('div');
          listItemTitleDiv.classList.add('listItemTitle');
          listItemTitleDiv.textContent = item.title;
          if (item.completed) {
            listItemTitleDiv.classList.add('completed');
          }

          const deleteButton = document.createElement('div');
          deleteButton.classList.add('delete');
          deleteButton.textContent = 'delete';
          deleteButton.addEventListener('click', function () {
            deleteItem(item.id);
            saveToLocalStorage();
          });

          listItemDiv.appendChild(sortButtonsContainerDiv);
          listItemDiv.appendChild(checkbox);
          listItemDiv.appendChild(listItemTitleDiv);
          listItemDiv.appendChild(deleteButton);

          appDiv.appendChild(listItemDiv);
        });
      };

      const saveToLocalStorage = () => {
        localStorage.setItem('itemList', JSON.stringify(itemList));
      };

      // Sayfa yüklendiğinde localStorage'dan verileri al
      const storedItemList = JSON.parse(localStorage.getItem('itemList'));
      if (storedItemList) {
        itemList.push(...storedItemList);
        render();
      }

      // Sayfa yüklendiğinde booleanValue true olarak ayarlanıyor
      booleanValue = true;

      render();
    });
  </script>
</body>

</html>
